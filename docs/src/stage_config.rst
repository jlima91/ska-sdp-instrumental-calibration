Stages and configurations
#########################

.. This page is generated using docs/generate_config.py

The descriptions of each stage are copied from the docstrings of stages.
Refer to the `API page for stages <api/ska_sdp_spectral_line_imaging.stages.html>`_

Each stage has parameters, which are defined in the YAML config file passed to the pipeline.


load_data
*********

    Load the Measurement Set data.

Parameters
==========

..  table::
    :width: 100%
    :widths: 15, 10, 10, 45, 10, 10

    +---------+--------+-----------+----------------------------------------+------------+------------------+
    | Param   | Type   | Default   | Description                            | Nullable   | Allowed values   |
    +=========+========+===========+========================================+============+==================+
    | fchunk  | int    | 32        | Number of frequency channels per chunk | True       |                  |
    +---------+--------+-----------+----------------------------------------+------------+------------------+


predict_vis
***********

    Predict model visibilities using a local sky model.

Parameters
==========

..  table::
    :width: 100%
    :widths: 15, 10, 10, 45, 10, 10

    +------------------+--------+-----------+----------------------------------------------------------------------------------+-------------------------------------+------------------+
    | Param            | Type   | Default   | Description                                                                      | Nullable                            | Allowed values   |
    +==================+========+===========+==================================================================================+=====================================+==================+
    | beam_type        | str    | everybeam | Type of beam model to use. Default is 'everybeam'                                | True                                |                  |
    +------------------+--------+-----------+----------------------------------------------------------------------------------+-------------------------------------+------------------+
    | eb_ms            | str    | None      | Measurement set need to initialise the everybeam             telescope. Required | True                                |                  |
    |                  |        |           | if bbeam_type is 'everybeam'.                                                    |                                     |                  |
    +------------------+--------+-----------+----------------------------------------------------------------------------------+-------------------------------------+------------------+
    | eb_coeffs        | str    | None      | Everybeam coeffs datadir containing beam             coefficients. Required if   | True                                |                  |
    |                  |        |           | bbeam_type is 'everybeam'.                                                       |                                     |                  |
    +------------------+--------+-----------+----------------------------------------------------------------------------------+-------------------------------------+------------------+
    | gleamfile        | str    | None      | Specifies the location of gleam catalogue             file gleamegc.dat          | True                                |                  |
    +------------------+--------+-----------+----------------------------------------------------------------------------------+-------------------------------------+------------------+
    | lsm_csv_path     | str    | None      | Specifies the location of CSV file for custom             components             | True                                |                  |
    +------------------+--------+-----------+----------------------------------------------------------------------------------+-------------------------------------+------------------+
    | fov              | float  | 10.0      | Specifies the width of the cone used when             searching for compoents,   | True                                |                  |
    |                  |        |           | in units of degrees. Default: 10.                                                |                                     |                  |
    +------------------+--------+-----------+----------------------------------------------------------------------------------+-------------------------------------+------------------+
    | flux_limit       | float  | 1.0       | Specifies the flux density limit used when             searching for compoents,  | True                                |                  |
    |                  |        |           | in units of Jy. Defaults to 1                                                    |                                     |                  |
    +------------------+--------+-----------+----------------------------------------------------------------------------------+-------------------------------------+------------------+
    | export_model_vis | bool   | False     | None                                                                             | Export predicted model visibilities |                  |
    +------------------+--------+-----------+----------------------------------------------------------------------------------+-------------------------------------+------------------+


bandpass_calibration
********************

    Performs Bandpass Calibration

Parameters
==========

..  table::
    :width: 100%
    :widths: 15, 10, 10, 45, 10, 10

    +--------------------------+--------+-------------------+---------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | Param                    | Type   | Default           | Description                                                               | Nullable   | Allowed values                                                                             |
    +==========================+========+===================+===========================================================================+============+============================================================================================+
    | run_solver_config.solver | str    | gain_substitution | Solver type to use. Currently any solver                 type accepted by | True       | ['gain_substitution', 'jones_substitution', 'normal_equations', 'normal_equations_presum'] |
    |                          |        |                   | solve_gaintable.                 Default is 'gain_substitution'.          |            |                                                                                            |
    +--------------------------+--------+-------------------+---------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | run_solver_config.refant | int    | 0                 | Reference antenna (defaults to 0).                                        | True       |                                                                                            |
    +--------------------------+--------+-------------------+---------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | run_solver_config.niter  | int    | 50                | Number of solver iterations (defaults to 50)                              | True       |                                                                                            |
    +--------------------------+--------+-------------------+---------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | plot_config.plot_table   | bool   | False             | Plot the generated gaintable                                              | True       |                                                                                            |
    +--------------------------+--------+-------------------+---------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | plot_config.fixed_axis   | bool   | False             | Limit amplitude axis to [0-1]                                             | True       |                                                                                            |
    +--------------------------+--------+-------------------+---------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | flagging                 | bool   | False             | Run RFI flagging                                                          | True       |                                                                                            |
    +--------------------------+--------+-------------------+---------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+


generate_channel_rm
*******************

    Generates channel rotation measures

Parameters
==========

..  table::
    :width: 100%
    :widths: 15, 10, 10, 45, 10, 10

    +--------------------------+--------+------------------+----------------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | Param                    | Type   | Default          | Description                                                                      | Nullable   | Allowed values                                                                             |
    +==========================+========+==================+==================================================================================+============+============================================================================================+
    | fchunk                   | int    | -1               | Number of frequency channels per chunk.             If set to -1, use fchunk     | True       |                                                                                            |
    |                          |        |                  | value from load_data                                                             |            |                                                                                            |
    +--------------------------+--------+------------------+----------------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | peak_threshold           | float  | 0.5              | Height of peak in the RM spectrum required             for a rotation detection. | True       |                                                                                            |
    +--------------------------+--------+------------------+----------------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | plot_table               | bool   | False            | Plot the generated gain table                                                    | True       |                                                                                            |
    +--------------------------+--------+------------------+----------------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | run_solver_config.solver | str    | normal_equations | Solver type to use. Currently any solver                 type accepted by        | True       | ['gain_substitution', 'jones_substitution', 'normal_equations', 'normal_equations_presum'] |
    |                          |        |                  | solve_gaintable.                 Default is 'normal_equations'.                  |            |                                                                                            |
    +--------------------------+--------+------------------+----------------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | run_solver_config.refant | int    | 0                | Reference antenna (defaults to 0).                                               | True       |                                                                                            |
    +--------------------------+--------+------------------+----------------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | run_solver_config.niter  | int    | 50               | Number of solver iterations (defaults to 50)                                     | True       |                                                                                            |
    +--------------------------+--------+------------------+----------------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+


delay_calibration
*****************

    Performs delay calibration

Parameters
==========

..  table::
    :width: 100%
    :widths: 15, 10, 10, 45, 10, 10

    +------------------------+--------+-----------+-------------------------------+------------+------------------+
    | Param                  | Type   | Default   | Description                   | Nullable   | Allowed values   |
    +========================+========+===========+===============================+============+==================+
    | oversample             | int    | 16        | Oversample rate               | True       |                  |
    +------------------------+--------+-----------+-------------------------------+------------+------------------+
    | plot_config.plot_table | bool   | False     | Plot the generated gaintable  | True       |                  |
    +------------------------+--------+-----------+-------------------------------+------------+------------------+
    | plot_config.fixed_axis | bool   | False     | Limit amplitude axis to [0-1] | True       |                  |
    +------------------------+--------+-----------+-------------------------------+------------+------------------+


export_gain_table
*****************

    Export gain table solutions to a file.

Parameters
==========

..  table::
    :width: 100%
    :widths: 15, 10, 10, 45, 10, 10

    +---------------+--------+-----------+----------------------------------------+------------+--------------------+
    | Param         | Type   | Default   | Description                            | Nullable   | Allowed values     |
    +===============+========+===========+========================================+============+====================+
    | file_name     | str    | gaintable | Gain table file name without extension | True       |                    |
    +---------------+--------+-----------+----------------------------------------+------------+--------------------+
    | export_format | str    | h5parm    | Export file format                     | True       | ['h5parm', 'hdf5'] |
    +---------------+--------+-----------+----------------------------------------+------------+--------------------+


Stages and configurations
#########################

.. This page is generated using docs/generate_config.py

The descriptions of each stage are copied from the docstrings of stages.
Refer to the `API page for stages <api/ska_sdp_spectral_line_imaging.stages.html>`_

Each stage has parameters, which are defined in the YAML config file passed to the pipeline.


load_data
*********

    Load the Measurement Set data.

Parameters
==========

..  table::
    :width: 100%
    :widths: 15, 10, 10, 45, 10, 10

    +---------+--------+-----------+----------------------------------------+------------+------------------+
    | Param   | Type   | Default   | Description                            | Nullable   | Allowed values   |
    +=========+========+===========+========================================+============+==================+
    | fchunk  | int    | 32        | Number of frequency channels per chunk | True       |                  |
    +---------+--------+-----------+----------------------------------------+------------+------------------+


predict_vis
***********

    Predict model visibilities using a local sky model.

Parameters
==========

..  table::
    :width: 100%
    :widths: 15, 10, 10, 45, 10, 10

    +------------------+--------+-----------+----------------------------------------------------------------------------------+-------------------------------------+------------------+
    | Param            | Type   | Default   | Description                                                                      | Nullable                            | Allowed values   |
    +==================+========+===========+==================================================================================+=====================================+==================+
    | beam_type        | str    | everybeam | Type of beam model to use. Default is 'everybeam'                                | True                                |                  |
    +------------------+--------+-----------+----------------------------------------------------------------------------------+-------------------------------------+------------------+
    | eb_ms            | str    | None      | Measurement set need to initialise the everybeam             telescope. Required | True                                |                  |
    |                  |        |           | if bbeam_type is 'everybeam'.                                                    |                                     |                  |
    +------------------+--------+-----------+----------------------------------------------------------------------------------+-------------------------------------+------------------+
    | eb_coeffs        | str    | None      | Everybeam coeffs datadir containing beam             coefficients. Required if   | True                                |                  |
    |                  |        |           | bbeam_type is 'everybeam'.                                                       |                                     |                  |
    +------------------+--------+-----------+----------------------------------------------------------------------------------+-------------------------------------+------------------+
    | gleamfile        | str    | None      | Specifies the location of gleam catalogue             file gleamegc.dat          | True                                |                  |
    +------------------+--------+-----------+----------------------------------------------------------------------------------+-------------------------------------+------------------+
    | fov              | float  | 10.0      | Specifies the width of the cone used when             searching for compoents,   | True                                |                  |
    |                  |        |           | in units of degrees. Default: 10.                                                |                                     |                  |
    +------------------+--------+-----------+----------------------------------------------------------------------------------+-------------------------------------+------------------+
    | flux_limit       | float  | 1.0       | Specifies the flux density limit used when             searching for compoents,  | True                                |                  |
    |                  |        |           | in units of Jy. Defaults to 1                                                    |                                     |                  |
    +------------------+--------+-----------+----------------------------------------------------------------------------------+-------------------------------------+------------------+
    | export_model_vis | bool   | False     | None                                                                             | Export predicted model visibilities |                  |
    +------------------+--------+-----------+----------------------------------------------------------------------------------+-------------------------------------+------------------+


bandpass_calibration
********************

    Performs Bandpass Calibration

Parameters
==========

..  table::
    :width: 100%
    :widths: 15, 10, 10, 45, 10, 10

    +--------------------------+--------+-------------------+---------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | Param                    | Type   | Default           | Description                                                               | Nullable   | Allowed values                                                                             |
    +==========================+========+===================+===========================================================================+============+============================================================================================+
    | run_solver_config.solver | str    | gain_substitution | Solver type to use. Currently any solver                 type accepted by | True       | ['gain_substitution', 'jones_substitution', 'normal_equations', 'normal_equations_presum'] |
    |                          |        |                   | solve_gaintable.                 Default is 'gain_substitution'.          |            |                                                                                            |
    +--------------------------+--------+-------------------+---------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | run_solver_config.refant | int    | 0                 | Reference antenna (defaults to 0).                                        | True       |                                                                                            |
    +--------------------------+--------+-------------------+---------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | run_solver_config.niter  | int    | 50                | Number of solver iterations (defaults to 50)                              | True       |                                                                                            |
    +--------------------------+--------+-------------------+---------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | plot_config.plot_table   | bool   | False             | Plot the generated gaintable                                              | True       |                                                                                            |
    +--------------------------+--------+-------------------+---------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | plot_config.fixed_axis   | bool   | False             | Limit amplitude axis to [0-1]                                             | True       |                                                                                            |
    +--------------------------+--------+-------------------+---------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | flagging                 | bool   | False             | Run RFI flagging                                                          | True       |                                                                                            |
    +--------------------------+--------+-------------------+---------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+


generate_channel_rm
*******************

    Generates channel rotation measures

Parameters
==========

..  table::
    :width: 100%
    :widths: 15, 10, 10, 45, 10, 10

    +--------------------------+--------+------------------+----------------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | Param                    | Type   | Default          | Description                                                                      | Nullable   | Allowed values                                                                             |
    +==========================+========+==================+==================================================================================+============+============================================================================================+
    | fchunk                   | int    | -1               | Number of frequency channels per chunk.             If set to -1, use fchunk     | True       |                                                                                            |
    |                          |        |                  | value from load_data                                                             |            |                                                                                            |
    +--------------------------+--------+------------------+----------------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | peak_threshold           | float  | 0.5              | Height of peak in the RM spectrum required             for a rotation detection. | True       |                                                                                            |
    +--------------------------+--------+------------------+----------------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | plot_table               | bool   | False            | Plot the generated gain table                                                    | True       |                                                                                            |
    +--------------------------+--------+------------------+----------------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | run_solver_config.solver | str    | normal_equations | Solver type to use. Currently any solver                 type accepted by        | True       | ['gain_substitution', 'jones_substitution', 'normal_equations', 'normal_equations_presum'] |
    |                          |        |                  | solve_gaintable.                 Default is 'normal_equations'.                  |            |                                                                                            |
    +--------------------------+--------+------------------+----------------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | run_solver_config.refant | int    | 0                | Reference antenna (defaults to 0).                                               | True       |                                                                                            |
    +--------------------------+--------+------------------+----------------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+
    | run_solver_config.niter  | int    | 50               | Number of solver iterations (defaults to 50)                                     | True       |                                                                                            |
    +--------------------------+--------+------------------+----------------------------------------------------------------------------------+------------+--------------------------------------------------------------------------------------------+


delay_calibration
*****************

    Performs delay calibration

Parameters
==========

..  table::
    :width: 100%
    :widths: 15, 10, 10, 45, 10, 10

    +------------------------+--------+-----------+-------------------------------+------------+------------------+
    | Param                  | Type   | Default   | Description                   | Nullable   | Allowed values   |
    +========================+========+===========+===============================+============+==================+
    | oversample             | int    | 16        | Oversample rate               | True       |                  |
    +------------------------+--------+-----------+-------------------------------+------------+------------------+
    | plot_config.plot_table | bool   | False     | Plot the generated gaintable  | True       |                  |
    +------------------------+--------+-----------+-------------------------------+------------+------------------+
    | plot_config.fixed_axis | bool   | False     | Limit amplitude axis to [0-1] | True       |                  |
    +------------------------+--------+-----------+-------------------------------+------------+------------------+


export_gain_table
*****************

    Export gain table solutions to a file.

Parameters
==========

..  table::
    :width: 100%
    :widths: 15, 10, 10, 45, 10, 10

    +---------------+--------+-----------+----------------------------------------+------------+--------------------+
    | Param         | Type   | Default   | Description                            | Nullable   | Allowed values     |
    +===============+========+===========+========================================+============+====================+
    | file_name     | str    | gaintable | Gain table file name without extension | True       |                    |
    +---------------+--------+-----------+----------------------------------------+------------+--------------------+
    | export_format | str    | h5parm    | Export file format                     | True       | ['h5parm', 'hdf5'] |
    +---------------+--------+-----------+----------------------------------------+------------+--------------------+
